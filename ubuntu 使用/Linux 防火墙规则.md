# Linux 防火墙配置

## 添加规则

- 命令行开启 `22` 端口

```
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
```

- 添加细致规则限制到机器

```
iptables -A INPUT -s 192.168.0.100 -p tcp --dport 22 -j ACCEPT
```

**使用命令行添加规则，重启后规则失效。**

## iptables 配置文件

- 文件路径：

```
/etc/sysconfig/iptables
```

- 文件内容：

```
# Generated by iptables-save v1.4.21 on Sat Mar 19 08:04:01 2016
*filter
:INPUT DROP [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [1:136]
:syn-flood - [0:0]
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 21 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 8080 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 60000:60003 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 20000:30000 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT
-A INPUT -p icmp -m limit --limit 100/sec --limit-burst 100 -j ACCEPT
-A INPUT -p icmp -m limit --limit 1/sec --limit-burst 10 -j ACCEPT
-A INPUT -p tcp -m tcp --tcp-flags FIN,SYN,RST,ACK SYN -j syn-flood
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A syn-flood -p tcp -m limit --limit 3/sec --limit-burst 6 -j RETURN
-A syn-flood -j REJECT --reject-with icmp-port-unreachable
COMMIT
```

开放 8080 ， 开放 60000到60003 端口。

```
-A INPUT -p tcp -m state --state NEW -m tcp --dport 8080 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 60000:60003 -j ACCEPT
```

## 参考链接

- [Linux配置防火墙详细步骤（iptables命令使用）](https://my.oschina.net/799835984/blog/663361)
- [CentOS下配置iptables防火墙](http://os.51cto.com/art/201103/249398.htm)
- [](https://wiki.archlinux.org/index.php/Iptables_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6)
